---
id: 202404020728
created: 2024-04-02 07:28
url: 
aliases:
  - Tools and rules
tags:
  - created/y2024
  - CVE/CVE-2024-3094
---

# Tools and rules

## Tools

- Upload your binary to [xz.fail][xzf] and check for the backdoor - by [binarly][bin]

## Rules

- Yara [rule](https://github.com/Neo23x0/signature-base/blob/master/yara/bkdr_xz_util_cve_2024_3094.yar) by [Neo23x](https://github.com/Neo23x0/) ie Florian Roth

## Find it

By [Will Dorman](https://infosec.exchange/@wdormann/112187297459865552)

```
Because it's not the version number of the xz code that shows if it's backdoored or not (the code in GitHub is clean), it's perhaps noting how one might tell if their 5.6.x code is backdoored or not.
If it has gl_path_map or gl_am_configmake in the source tree anywhere, look out.
```

![[Pasted image 20240331100021.png]]

## Honeypots and tests

- [lockness-Ko/xz-vulnerable-honeypot][xvh]
- [amlweems/xzbot][xbo]
- [Instructions][ikl] on the Kali Linux blog
- [Jia Tan's SSH Agent][jts] - Simple SSH Agent that implements some of the XZ sshd backdoor functionality. Written in Python.


[bin]: https://www.binarly.io/blog/xz-utils-supply-chain-puzzle-binarly-ships-free-scanner-for-cve-2024-3094-backdoor
[ikl]: https://www.kali.org/blog/xz-backdoor-getting-started/
[jts]: https://github.com/blasty/JiaTansSSHAgent
[xbo]: https://github.com/amlweems/xzbot
[xvh]: https://github.com/lockness-Ko/xz-vulnerable-honeypot
[xzf]: https://xz.fail/

Last changed: `$= dv.current().file.mtime`