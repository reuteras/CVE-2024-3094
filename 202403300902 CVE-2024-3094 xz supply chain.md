---
id: 202403300902
created: 2024-03-30 09:02
cssclass: hide-embedded-header2
url: https://nvd.nist.gov/vuln/detail/CVE-2024-3094
aliases:
  - CVE-2024-3094 xz supply chain
tags:
  - created/y2024
  - CVE/CVE-2024-3094
---

# CVE-2024-3094 xz supply chain

This is regarding a backdoor in [[202403310919 xz|xz]]. As pointed out in this blog post, [The XZ Utils backdoor is a symptom of a larger problem][ars], I shouldn't have used the term supply chain without clarification. I don't have a better term but by using it I'm not implying any obligation by the original maintainer of xz to patch, fix och extend the library.

| CWE-ID | CWE Name |
| --- | --- |
| CWE-506 | Embedded Malicious Code |

First public report was made to the [oss-security][oss] list by [Andres Freund][afm]. Some early reports where a GitHub [advisory][gad], Red Hat [blog][rhb] and [CVE-2024-3094][rhc] and a advisory from [CISA][cis].

[Thomas Roccia](https://infosec.exchange/@fr0gger/112189232773640259) has created this nice overview image:

![[Pasted image 20240331144449.png]]

## Separate notes

Note for the [[202403310952 CVE-2024-3094 backdoor|CVE-2024-3094 backdoor]] and some of the persons or personas involved:

- [[202403301312 CVE-2024-3094 -Jia Tan|CVE-2024-3094 -Jia Tan]]
- [[202403301317 CVE-2024-3094 - Lasse Collin|CVE-2024-3094 - Lasse Collin]]
- [[202403310857 CVE-2024-3094 - Hans Jansen|CVE-2024-3094 - Hans Jansen]]

[[202404020728 Tools and rules|Tools and rules]] for finding the backdoor. What can be done in the future to [[202404020805 Prevention]] the next attempt? [[202404041707 Fallout]] from this backdoor.

Find [[202404030944 Similar attempts]].

There are som lighter notes that can make you [[202404020708 smile]] a little i all of this.


## Resources

There are many collections about this backdoor and many of them are constantly being updated.

- [FAQ on the xz-utils backdoor][faq] by Sam James ([thesamesam][sag])
- [xz/liblzma Compromise Link Roundup][clr] by [Mike Sass][mis]
- [Backdoor Discovered in xz/liblzma Compression Library][bdc] on Sources & Methods and written by [Matthew Conway][mac]
- [The xz backdoor from a Security Engineer perspective][sep] by [Francesco Giordano][frg]
- [Everything I Know About the Xz Backdoor][eik] by [Evan Boehs][evb]
- [Backdoor in XZ Utils allows RCE: everything you need to know][wiz] by Wiz.io
- [XZ Utils backdoor][xub] by the original creator and maintainer of the XZ Utils project Lasse Collin.

## Affected

A [list with affected](https://xeiaso.net/notes/2024/xz-vuln/) distributions by xeiaso.net. Individual messages from some distributions below.

- [Debian](https://lists.debian.org/debian-security-announce/2024/msg00057.html)
- [Homebrew](https://github.com/orgs/Homebrew/discussions/5243#discussioncomment-8954951)
- [OpenSUSE](https://build.opensuse.org/request/show/1163302)
- [Kali](https://www.kali.org/blog/about-the-xz-backdoor/) and on [infosec.exchange](https://infosec.exchange/@kalilinux/112180505434870941)
- [RedHat](https://bugzilla.redhat.com/show_bug.cgi?id=2272210)

### Debian

- https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63
- https://security-tracker.debian.org/tracker/source-package/xz-utils
- https://security-tracker.debian.org/tracker/CVE-2024-3094
- Look at [all](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024) commits by [[202403301312 CVE-2024-3094 -Jia Tan|CVE-2024-3094 -Jia Tan]].

### Linux kernel

Attempts to get this into the Linux kernel.

- https://lore.kernel.org/lkml/20240320183846.19475-1-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-2-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-3-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-4-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-5-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-6-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-7-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-8-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-9-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-10-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-11-lasse.collin@tukaani.org/t

Removed here https://lore.kernel.org/lkml/202403291736.B7E9C61@keescook/

Documentation about [XZ data compression in Linux](https://docs.kernel.org/staging/xz.html).

## Analysis

- High level analysis by [René Mayrhofer][rem]
- [Malicious xz backdoor reveals fragility of open source][mbr] by The Register
- [OpenSSH and XZ/liblzma: A nation-state attack was thwarted, what did we learn?][nsa] by Justin Cormack at Docker
- Space Rogou [wrote][spr] _Everyone is saying_ **xz** _will be a wake up call for security, when if anything it will just be another snooze button._
- [XZ Backdoor (CVE-2024-3094): A Multi-Year Effort By An Advanced Threat Actor][mye] by Emanuele De Lucia
- [Backdoor in XZ Utils That Almost Happened][bta] by Bruce Schneier in Lawfare
- [The Hidden Economy of Open Source Software][heo] by sysdig
- [Fallout from XZ/SSH supply chain attack continues][fsc] by P Ducklin
- [XZ backdoor story – Initial analysis][bsi] by Kaspersky
- [Free software's not-so-eXZellent adventure][lwn] by LWN
- [On the critical path to implant backdoors and the effectiveness of potential mitigation techniques: Early learnings from XZ][arx] ([arXiv:2404.08987][arx])
- An email on [oss-security][os1] about `update on some developments in the recent 2 weeks`.

### Podcasts

- [Between Two Nerds: The human side of the XZ supply chain attack][btn]

## Other projects possible affected

### libarchive

- https://github.com/libarchive/libarchive/pull/1609 and fixed in https://github.com/libarchive/libarchive/pull/2101

Via a comment by [fuomag9](fuo) we can see that JiaT75 is mentioned as a contributor to [Microsoft C++ docs: What's new for August 2023 to November 2023][mic]


## News and alerts

### General news about the backdoor.

- [Backdoor found in widely used Linux utility breaks encrypted SSH connections][at1] by Ars Technica
- [What we know about the xz Utils backdoor that almost infected the world][at2] by Ars Technica is a good starting point to read.
- [Red Hat warns of backdoor in XZ tools used by most Linux distros][bc1] by Bleeping Computer
- [Beware! Backdoor found in XZ utilities used by many Linux distros (CVE-2024-3094)][ns1] by Help net security 

### CERT alerts

Since the Internet Storm Center added this page, [The xz-utils backdoor in security advisories by national CSIRTs][isb], I will not update this section more.

- 2024-03-29 - [CISA](https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094)
- 2024-03-30 11:29:37 - [CERT-EU](https://www.cert.europa.eu/publications/security-advisories/2024-032/)
- 2024-03-30 16:21 - [CERT-SE](https://www.cert.se/2024/03/kritisk-sarbarhet-i-xz-utils.html)
- 2024-03-30 - [CIRC.LU](https://www.circl.lu/pub/tr-82/)

### Security vendors

Some security vendors responses and blogs

- JFrog has a very good post, [CVE-2024-3094 XZ Backdoor: All you need to know][jfb], but **don't** use their [tool][jft] since it uses ldd and you should never use ldd on untrusted binaries as per the manual and this [blog][ldb] referring to the [manual][ldm]. 
- [Frequently Asked Questions About CVE-2024-3094, A Backdoor in XZ Utils][ten] by Tenable
-  [A software supply chain meltdown: What we know about the XZ Trojan][rel] by ReversingLabs
- [Backdoored XZ Utils (CVE-2024-3094)][br7] by Rapid7 - nothing special
- [xz/liblzma Backdoor: Open Source Nuke? Maybe Not That Bad!][osn] - by HardenedVault
- [XZ Utils Backdoor — Everything You Need to Know, and What You Can Do][aka] - Akamai
- [XZ SSH Backdoor Detection Strategies][bds] by The Sandfly Security Team
- [Defense in depth: XZ Utils][did] by Wiz

### Earlier attempts to do supply chain attacks.

- Earlier attempt by researcher to test supply chain security [Linux kernel team rejects University of Minnesota researchers’ apology](https://arstechnica.com/gadgets/2021/04/linux-kernel-team-rejects-university-of-minnesota-researchers-apology/)
- Fdroid had a similar attempt in as [mentioned][fdr] by [Hans-Christoph Steiner][hcs].

## Tips

Don't use tools like [ldd][ldb] or even [strings][str] on untrusted binaries. 


[afm]: https://mastodon.social/@AndresFreundTec/112180406142695845
[aka]: https://www.akamai.com/blog/security-research/2024/apr/critical-linux-backdoor-xz-utils-discovered-what-to-know
[ars]: https://ariadne.space/2024/04/02/the-xz-utils-backdoor-is-a-symptom-of-a-larger-problem/
[arx]: https://arxiv.org/abs/2404.08987
[at1]: https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/
[at2]: https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/
[bc1]: https://www.bleepingcomputer.com/news/security/red-hat-warns-of-backdoor-in-xz-tools-used-by-most-linux-distros/
[bdc]: https://sourcesmethods.com/xz-utils-backdoor-discovered/
[bds]: https://sandflysecurity.com/blog/xz-ssh-backdoor-detection-strategies/
[br7]: https://www.rapid7.com/blog/post/2024/04/01/etr-backdoored-xz-utils-cve-2024-3094/
[bsi]: https://securelist.com/xz-backdoor-story-part-1/112354/
[bta]: https://www.lawfaremedia.org/article/backdoor-in-xz-utils-that-almost-happened
[btn]: https://risky.biz/BTN74/
[cis]: https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094
[clr]: https://shellsharks.com/xz-compromise-link-roundup
[did]: https://www.wiz.io/blog/xz-utils-defense-in-depth
[eik]: https://boehs.org/node/everything-i-know-about-the-xz-backdoor
[evb]: https://boehs.org/
[faq]: https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27
[fdr]: https://social.librem.one/@eighthave/112194828562355097
[frg]: https://appsec.space/about/
[fsc]: https://pducklin.com/2024/04/10/fallout-from-xz-ssh-supply-chain-attack-continues/
[fuo]: https://cyberplace.social/@fuomag9@lime.fuo.fi/112181491492046188
[gad]: https://github.com/advisories/GHSA-rxwq-x6h5-x525
[hcs]: https://social.librem.one/@eighthave
[heo]: https://sysdig.com/blog/hidden-economy-of-open-source-software/
[isb]: https://isc.sans.edu/forums/diary/The+xzutils+backdoor+in+security+advisories+by+national+CSIRTs/30800/)
[isc]: https://isc.sans.edu/
[jfb]: https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/
[jft]: https://github.com/jfrog/cve-2024-3094-tools/blob/main/cve-2024-3094-detector/cve-2024-3094-detector.sh
[ldb]: https://jmmv.dev/2023/07/ldd-untrusted-binaries.html
[ldm]: https://man7.org/linux/man-pages/man1/ldd.1.html
[lwn]: https://lwn.net/Articles/967866/
[mac]: https://mattreduce.com/
[mbr]: https://www.theregister.com/2024/04/01/xz_backdoor_open_source/
[mic]: https://learn.microsoft.com/en-US/cpp/overview/whats-new-cpp-docs?view=msvc-170#community-contributors
[mis]: https://shellsharks.com/about
[mye]: https://www.emanueledelucia.net/xz-backdoor-cve-2024-3094-a-multi-year-effort-by-an-advanced-threat-actor/
[ns1]: https://www.helpnetsecurity.com/2024/03/29/cve-2024-3094-linux-backdoor/
[nsa]: https://www.docker.com/blog/openssh-and-xz-liblzma/
[os1]: https://www.openwall.com/lists/oss-security/2024/04/16/5
[osn]: https://hardenedvault.net/blog/2024-03-31-xz-lzma-backdoor-open-source-nuke/
[oss]: https://www.openwall.com/lists/oss-security/2024/03/29/4
[rel]: https://www.reversinglabs.com/blog/a-software-supply-chain-meltdown-what-we-know-about-xz-trojan
[rem]: https://infosec.exchange/@rene_mobile/112186879554070328
[rhb]: https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users
[rhc]: https://access.redhat.com/security/cve/CVE-2024-3094
[sag]: https://gist.github.com/thesamesam
[sep]: https://appsec.space/posts/xz-backdoor/
[spr]: https://mastodon.social/@spacerog/112187090837590009
[str]: https://lcamtuf.blogspot.com/2014/10/psa-dont-run-strings-on-untrusted-files.html
[ten]: https://www.tenable.com/blog/frequently-asked-questions-cve-2024-3094-supply-chain-backdoor-in-xz-utils
[wiz]: https://www.wiz.io/blog/cve-2024-3094-critical-rce-vulnerability-found-in-xz-utils
[xub]: https://tukaani.org/xz-backdoor/

Last changed: `$= dv.current().file.mtime`