---
id: 202403300902
created: 2024-03-30 09:02
cssclass: hide-embedded-header2
url: https://nvd.nist.gov/vuln/detail/CVE-2024-3094
aliases:
  - CVE-2024-3094 xz supply chain
tags:
  - created/y2024
  - CVE/CVE-2024-3094
---

# CVE-2024-3094 xz supply chain

This is regarding a backdoor in [[202403310919 xz|xz]].

| CWE-ID | CWE Name |
| --- | --- |
| CWE-506 | Embedded Malicious Code |

First public report was made to the [oss-security][oss] list by [Andres Freund][afm]. Some early reports where a GitHub [advisory][gad], Red Hat [blog][rhb] and [CVE-2024-3094][rhc] and a advisory from [CISA][cis].

[Thomas Roccia](https://infosec.exchange/@fr0gger/112189232773640259) has created this nice overview image:

![[Pasted image 20240331144449.png]]

## Separate notes

Note for the [[202403310952 CVE-2024-3094 backdoor|CVE-2024-3094 backdoor]] and some of the persons or personas involved:

- [[202403301312 CVE-2024-3094 -Jia Tan|CVE-2024-3094 -Jia Tan]]
- [[202403301317 CVE-2024-3094 - Lasse Collin|CVE-2024-3094 - Lasse Collin]]
- [[202403310857 CVE-2024-3094 - Hans Jansen|CVE-2024-3094 - Hans Jansen]]

[[202404020728 Tools and rules|Tools and rules]] for finding the backdoor.

There are som lighter notes that can make you [[202404020708 smile]] a little i all of this.


## Resources

There are many collections about this backdoor and many of them are constantly being updated.

- [FAQ on the xz-utils backdoor][faq] by Sam James ([thesamesam][sag])
- [xz/liblzma Compromise Link Roundup][clr] by [Mike Sass][mis]
- [Backdoor Discovered in xz/liblzma Compression Library][bdc] on Sources & Methods and written by [Matthew Conway][mac]
- [The xz backdoor from a Security Engineer perspective][sep] by [Francesco Giordano][frg]
- [Everything I Know About the Xz Backdoor][eik] by [Evan Boehs][evb]
- [Backdoor in XZ Utils allows RCE: everything you need to know][wiz] by Wiz.io

## Affected

A [list with affected](https://xeiaso.net/notes/2024/xz-vuln/) distributions by xeiaso.net. Individual messages from some distributions below.

- [Debian](https://lists.debian.org/debian-security-announce/2024/msg00057.html)
- [Homebrew](https://github.com/orgs/Homebrew/discussions/5243#discussioncomment-8954951)
- [OpenSUSE](https://build.opensuse.org/request/show/1163302)
- [Kali](https://www.kali.org/blog/about-the-xz-backdoor/) and on [infosec.exchange](https://infosec.exchange/@kalilinux/112180505434870941)
- [RedHat](https://bugzilla.redhat.com/show_bug.cgi?id=2272210)

### Debian

- https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63
- https://security-tracker.debian.org/tracker/source-package/xz-utils
- https://security-tracker.debian.org/tracker/CVE-2024-3094
- Look at [all](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024) commits by [[202403301312 CVE-2024-3094 -Jia Tan|CVE-2024-3094 -Jia Tan]].

### Linux kernel

Attempts to get this into the Linux kernel.

- https://lore.kernel.org/lkml/20240320183846.19475-1-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-2-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-3-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-4-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-5-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-6-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-7-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-8-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-9-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-10-lasse.collin@tukaani.org/t
- https://lore.kernel.org/lkml/20240320183846.19475-11-lasse.collin@tukaani.org/t

Removed here https://lore.kernel.org/lkml/202403291736.B7E9C61@keescook/

Documentation about [XZ data compression in Linux](https://docs.kernel.org/staging/xz.html).

## Analysis

- High level analysis by [René Mayrhofer][rem]
- Space Rogou [wrote][spr] _Everyone is saying_ **xz** _will be a wake up call for security, when if anything it will just be another snooze button._

## Other projects possible affected

### libarchive

- https://github.com/libarchive/libarchive/pull/1609 and fixed in https://github.com/libarchive/libarchive/pull/2101

Via a comment by [fuomag9](fuo) we can see that JiaT75 is mentioned as a contributor to [Microsoft C++ docs: What's new for August 2023 to November 2023][mic]


## News and alerts

### General news about the backdoor.

- [Backdoor found in widely used Linux utility breaks encrypted SSH connections][at1] by Ars Technica
- [What we know about the xz Utils backdoor that almost infected the world][at2] by Ars Technica is a good starting point to read.
- [Red Hat warns of backdoor in XZ tools used by most Linux distros][bc1] by Bleeping Computer
- [Beware! Backdoor found in XZ utilities used by many Linux distros (CVE-2024-3094)][ns1] by Help net security 

### CERT alerts 

- 2024-03-29 - [CISA](https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094)
- 2024-03-30 11:29:37 - [CERT-EU](https://www.cert.europa.eu/publications/security-advisories/2024-032/)
- 2024-03-30 16:21 - [CERT-SE](https://www.cert.se/2024/03/kritisk-sarbarhet-i-xz-utils.html)
- 2024-03-30 - [CIRC.LU](https://www.circl.lu/pub/tr-82/)

### Earlier attempts to do supply chain attacks.

- Earlier attempt by researcher to test supply chain security [Linux kernel team rejects University of Minnesota researchers’ apology](https://arstechnica.com/gadgets/2021/04/linux-kernel-team-rejects-university-of-minnesota-researchers-apology/)
- Fdroid had a similar attempt in as [mentioned][fdr] by [Hans-Christoph Steiner][hcs].



[afm]: https://mastodon.social/@AndresFreundTec/112180406142695845
[at1]: https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/
[at2]: https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/
[bc1]: https://www.bleepingcomputer.com/news/security/red-hat-warns-of-backdoor-in-xz-tools-used-by-most-linux-distros/
[bdc]: https://sourcesmethods.com/xz-utils-backdoor-discovered/
[cis]: https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094
[clr]: https://shellsharks.com/xz-compromise-link-roundup
[eik]: https://boehs.org/node/everything-i-know-about-the-xz-backdoor
[evb]: https://boehs.org/
[faq]: https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27
[fdr]: https://social.librem.one/@eighthave/112194828562355097
[frg]: https://appsec.space/about/
[fuo]: https://cyberplace.social/@fuomag9@lime.fuo.fi/112181491492046188
[hcs]: https://social.librem.one/@eighthave
[gad]: https://github.com/advisories/GHSA-rxwq-x6h5-x525
[mac]: https://mattreduce.com/
[mic]: https://learn.microsoft.com/en-US/cpp/overview/whats-new-cpp-docs?view=msvc-170#community-contributors
[mis]: https://shellsharks.com/about
[ns1]: https://www.helpnetsecurity.com/2024/03/29/cve-2024-3094-linux-backdoor/
[oss]: https://www.openwall.com/lists/oss-security/2024/03/29/4
[rem]: https://infosec.exchange/@rene_mobile/112186879554070328
[rhb]: https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users
[rhc]: https://access.redhat.com/security/cve/CVE-2024-3094
[sag]: https://gist.github.com/thesamesam
[sep]: https://appsec.space/posts/xz-backdoor/
[spr]: https://mastodon.social/@spacerog/112187090837590009
[wiz]: https://www.wiz.io/blog/cve-2024-3094-critical-rce-vulnerability-found-in-xz-utils

Last changed: `$= dv.current().file.mtime`